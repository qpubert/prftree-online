(this["webpackJsonpprftree-online"]=this["webpackJsonpprftree-online"]||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var r=n(115),a=n(29),i=n(30),s=n(32),u=n(31),o=n(1),c=n(5),l=n.n(c),d=n(107),p=n.n(d),h=n(49),f=n(108),v=n(116),b=n(113),j=n.n(b),m=n(114),x=n.n(m),I=(n(308),function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=!1===this.props.onUndo,t=!1===this.props.onRedo,n=Object(o.jsxs)("div",{className:"input-pane pane",onClick:this.props.onViewClick,children:[Object(o.jsxs)("div",{id:"history-buttons",children:[Object(o.jsx)("button",{onClick:e?void 0:this.props.onUndo,disabled:e,children:"Undo"}),Object(o.jsx)("button",{onClick:t?void 0:this.props.onRedo,disabled:t,children:"Redo"})]}),Object(o.jsx)("div",{className:"tree-wrapper",children:this.props.rootNode})]});return Object(o.jsxs)(h.a,{className:"left-pane",sizes:[80,20],minSize:0,expandToMin:!1,gutterSize:10,gutterAlign:"center",snapOffset:30,dragInterval:1,direction:"vertical",cursor:"row-resize",children:[n,Object(o.jsx)("textarea",{className:"error-message-pane pane",value:this.props.errorMsg,readOnly:!0})]})}}]),n}(l.a.Component)),O=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(o.jsx)("textarea",{className:"output-pane pane",value:this.props.outputSource,readOnly:!0})}}]),n}(l.a.Component),y=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).currentLatexInputRef=l.a.createRef(),r.state={history:[r.createBlankNode()],currentVersion:0,focusedInputId:null,focusWasPerformed:!1},r}return Object(i.a)(n,[{key:"createBlankNode",value:function(e){return{parentId:e,id:Object(v.a)(),assumptions:[],labelInput:this.createBlankLatexInput(),ruleNameInput:this.createBlankLatexInput(),conclusionInput:this.createBlankLatexInput(),lineType:"straight",lineDoubled:!1}}},{key:"createBlankLatexInput",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{id:Object(v.a)(),value:e,errorMsg:""}}},{key:"findNodeRec",value:function(e,t){if(t(e))return e;var n,a=Object(r.a)(e.assumptions);try{for(a.s();!(n=a.n()).done;){var i=n.value,s=this.findNodeRec(i,t);if(void 0!==s)return s}}catch(u){a.e(u)}finally{a.f()}}},{key:"findLatexInputRec",value:function(e,t){var n=this.findNodeRec(e,(function(e){return-1!==[e.labelInput,e.ruleNameInput,e.conclusionInput].findIndex(t)}));if(void 0!==n)return[n.labelInput,n.ruleNameInput,n.conclusionInput].find(t)}},{key:"updateNodeStateOnEvent",value:function(e,t,n){var r=this;return function(a){var i=j()(r.state.history[r.state.currentVersion]);n(r.findNodeRec(i,(function(e){return e.id===t})),a),r.setState((function(t){return{history:e?t.history.slice(0,t.currentVersion+1).concat([i]):t.history.map((function(e,n){return n===t.currentVersion?i:e})),currentVersion:e?t.currentVersion+1:t.currentVersion}}))}}},{key:"updateLatexInputStateOnEvent",value:function(e,t,n,r){var a=this;return this.updateNodeStateOnEvent(e,t,(function(e,t){r(a.findLatexInputRec(e,(function(e){return e.id===n})),t)}))}},{key:"renderLatexInput",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a="\u25a1",i=this.state.focusedInputId&&t.id==this.state.focusedInputId,s=i||""!==t.errorMsg,u=i&&!this.state.focusWasPerformed;return Object(o.jsxs)("div",{className:"latex-input-wrapper",onClick:function(e){e.stopPropagation()},children:[Object(o.jsx)("div",{className:"latex-input-output",tabIndex:0,onFocus:function(e){n.setState({focusedInputId:t.id,focusWasPerformed:!1})},hidden:s,children:Object(o.jsx)(f.a,{display:!1,tex:r?"\\small{\\text{".concat(0===t.value.length?a:t.value,"}}"):"".concat(0===t.value.length?a:t.value),onError:this.updateLatexInputStateOnEvent(!1,e.id,t.id,(function(e,t){e.errorMsg=t})),onSuccess:this.updateLatexInputStateOnEvent(!1,e.id,t.id,(function(e,t){e.errorMsg=""}))})}),s&&Object(o.jsx)("div",{className:"latex-input-input",children:Object(o.jsx)("input",{className:""===t.errorMsg?"":"invalid-latex-input",type:"text",placeholder:a,defaultValue:t.value,style:{width:"".concat(Math.max(a.length,t.value.length),"ch")},onInput:this.updateLatexInputStateOnEvent(!1,e.id,t.id,(function(e,t){e.value=t.target.value})),ref:i?this.currentLatexInputRef:null,onFocus:this.updateLatexInputStateOnEvent(u,e.id,t.id,(function(e,r){n.setState({focusedInputId:t.id})})),onBlur:function(e){x()(n.state.history[n.state.currentVersion],n.state.history[n.state.currentVersion-1])&&n.setState((function(e){return{history:e.history.filter((function(t,n){return n!==e.currentVersion})),currentVersion:e.currentVersion-1}}))}})})]})}},{key:"componentDidUpdate",value:function(){this.currentLatexInputRef.current&&!this.state.focusWasPerformed&&(this.currentLatexInputRef.current.focus(),this.currentLatexInputRef.current.setSelectionRange(0,this.currentLatexInputRef.current.value.length),this.setState({focusWasPerformed:!0}))}},{key:"renderNode",value:function(e){var t=this,n=e.lineDoubled&&"none"===e.lineType;return Object(o.jsxs)("div",{className:"node-wrapper",children:[!n&&Object(o.jsx)("div",{className:"label",children:this.renderLatexInput(e,e.labelInput,!0)}),Object(o.jsxs)("div",{className:"node",children:[Object(o.jsxs)("div",{className:"assumptions ".concat(0===e.assumptions.length?"":"not-empty-assumptions"),children:[e.assumptions.map((function(e,n){return t.renderNode(e,n)})),Object(o.jsx)("button",{onClick:this.updateNodeStateOnEvent(!0,e.id,(function(n){var r=t.createBlankNode(n.id);n.assumptions=e.assumptions.concat([r])})),children:"+"}),e.parentId?Object(o.jsx)("button",{onClick:this.updateNodeStateOnEvent(!0,e.parentId,(function(t){t.assumptions=t.assumptions.filter((function(t){return t.id!==e.id}))})),children:"-"}):null]}),n?Object(o.jsxs)("div",{className:"proof-summary",children:[Object(o.jsx)("div",{className:"inference-line line-type-".concat(e.lineType," ").concat(e.lineDoubled?"line-doubled":""),onClick:this.updateNodeStateOnEvent(!0,e.id,(function(e){var t=["none","straight","dotted","dashed"];e.lineType=t[(t.indexOf(e.lineType)+1)%t.length],"none"===e.lineType&&(e.lineDoubled=!e.lineDoubled)}))}),Object(o.jsx)("div",{className:"proof-summary-rule-name rule-name",children:this.renderLatexInput(e,e.ruleNameInput,!0)})]}):Object(o.jsx)("div",{className:"inference-line line-type-".concat(e.lineType," ").concat(e.lineDoubled?"line-doubled":""),onClick:this.updateNodeStateOnEvent(!0,e.id,(function(e){var t=["none","straight","dotted","dashed"];e.lineType=t[(t.indexOf(e.lineType)+1)%t.length],"none"===e.lineType&&(e.lineDoubled=!e.lineDoubled)}))}),Object(o.jsx)("div",{className:"conclusion",children:this.renderLatexInput(e,e.conclusionInput,!1)})]}),!n&&Object(o.jsx)("div",{className:"rule-name",children:this.renderLatexInput(e,e.ruleNameInput,!0)})]},e.id)}},{key:"generateNodeSource",value:function(e,t,n){var r=this,a=e.lineDoubled&&"none"===e.lineType,i=n.repeat(t)+(a?"\\prfsummary":"\\prftree");if(a)""!==e.ruleNameInput.value&&(i+="[".concat(e.ruleNameInput.value,"]"));else{switch(e.lineDoubled&&(i+="[double]"),e.lineType){case"none":i+="[noline]";break;case"straight":break;default:i+="[".concat(e.lineType,"]")}""!==e.labelInput.value&&(i+="[l]{".concat(e.labelInput.value,"}")),""!==e.ruleNameInput.value&&(i+="[r]{".concat(e.ruleNameInput.value,"}"))}return i+="\n",0===e.assumptions.length?(i+=n.repeat(t),i+="{ ".concat(e.conclusionInput.value," }\n")):(e.assumptions.map((function(e){i+=n.repeat(t),i+="{\n",i+="".concat(r.generateNodeSource(e,t+1,n)),i+=n.repeat(t),i+="}\n"})),i+=n.repeat(t),i+="{ ".concat(e.conclusionInput.value," }\n")),i}},{key:"render",value:function(){var e=this,t=this.state.history[this.state.currentVersion],n=this.findLatexInputRec(t,(function(t){return t.id===e.state.focusedInputId})),r=n?n.errorMsg:"";return console.log("errorMsg ".concat(r," focusedInput ").concat(n)),Object(o.jsxs)(h.a,{className:"live-editor",sizes:[50,50],minSize:100,expandToMin:!1,gutterSize:10,gutterAlign:"center",snapOffset:30,dragInterval:1,direction:"horizontal",cursor:"col-resize",children:[Object(o.jsx)(I,{rootNode:this.renderNode(t,[]),errorMsg:r,onViewClick:function(){e.setState({focusedInputId:null})},onUndo:this.state.currentVersion>0&&function(){e.setState((function(e){return{currentVersion:e.currentVersion-1}}))},onRedo:this.state.currentVersion<this.state.history.length-1&&function(){e.setState((function(e){return{currentVersion:e.currentVersion+1}}))}}),Object(o.jsx)(O,{outputSource:this.generateNodeSource(t,0,"    ")})]})}}]),n}(l.a.Component);p.a.render(Object(o.jsx)(y,{}),document.getElementById("root"))},302:function(e,t){},308:function(e,t,n){}},[[117,1,2]]]);
//# sourceMappingURL=main.c48c9b98.chunk.js.map